<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Calculadora de Gestión Humana y Estrategia Competitiva — Urbaser Montería</title>
<style>
  :root{--bg:#0b1320;--card:#111a2b;--muted:#94a3b8;--text:#e2e8f0;--accent:#22c55e;--accent2:#60a5fa;--danger:#ef4444}
  *{box-sizing:border-box} body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#081023,#0b1320 30%,#0a172b);color:var(--text)}
  header{padding:24px 20px 8px; text-align:center}
  h1{margin:0;font-size:clamp(18px,3vw,28px)}
  p.lead{margin:6px auto 18px;max-width:900px;color:var(--muted)}
  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  .tabs{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
  .tabbtn{border:1px solid #1f2a44;background:#0d1627;color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer}
  .tabbtn.active{background:linear-gradient(90deg,#12402a,#1d854e);border-color:#1d854e}
  .card{background:var(--card);border:1px solid #1f2a44;border-radius:16px;padding:16px;margin:14px 0;box-shadow:0 10px 25px rgba(0,0,0,.25)}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
  label{display:block;font-size:12px;color:var(--muted);margin-bottom:4px}
  input,select{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #29344f;background:#0e1a2c;color:var(--text)}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px 8px;border-bottom:1px solid #223052;text-align:right}
  th{color:#9fb3c8;font-weight:600}
  td:first-child,th:first-child{text-align:left}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .btn{padding:10px 14px;border-radius:12px;border:1px solid #24455f;background:#0f2238;color:var(--text);cursor:pointer}
  .btn.primary{background:linear-gradient(90deg,#1f6b3f,#22c55e);border-color:#22c55e;color:#04150d}
  .btn.ghost{background:#0e1a2c;border-color:#2b3d63}
  .pill{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid #2c3d61;color:#9fb3c8;font-size:12px}
  .kpi{display:flex;align-items:baseline;gap:6px}
  .kpi .big{font-size:28px;font-weight:800}
  .ok{color:var(--accent)} .warn{color:#f59e0b} .bad{color:var(--danger)}
  footer{padding:24px;color:#7a8cab;text-align:center}
</style>
</head>
<body>
<header>
  <h1>Calculadora de Gestión Humana y Estrategia Competitiva</h1>
  <p class="lead">Herramientas prácticas para <b>Urbaser Montería</b>: dimensionamiento de dotación, evaluación e incentivos por cuadrilla, y ROI de formación. Ajusta parámetros, captura tus datos y obtén resultados al instante.</p>
</header>
<div class="wrap">
  <div class="tabs">
    <button class="tabbtn active" data-tab="dotacion">Dotación por microrruta</button>
    <button class="tabbtn" data-tab="desempeno">Desempeño e incentivos</button>
    <button class="tabbtn" data-tab="roi">Formación y ROI</button>
  </div>

  <!-- DOTACIÓN -->
  <section id="dotacion" class="card">
    <h2>1) Calculadora de dotación</h2>
    <p class="lead">Cálculo de FTE requeridos por microrruta para <i>barrido</i> y <i>recolección</i> con reserva por ausentismo y disponibilidad efectiva.</p>
    <div class="grid">
      <div>
        <label>Rendimiento de barrido (km/persona·día)</label>
        <input type="number" id="rb" value="4" step="0.1"/>
      </div>
      <div>
        <label>Rendimiento de recolección (t/persona·día)</label>
        <input type="number" id="rr" value="6.5" step="0.1"/>
      </div>
      <div>
        <label>Reserva por ausentismo α (0–1)</label>
        <input type="number" id="alpha" value="0.25" step="0.01"/>
      </div>
      <div>
        <label>Disponibilidad efectiva η (0–1)</label>
        <input type="number" id="eta" value="0.9" step="0.01"/>
      </div>
      <div>
        <label>Distribución mañana (%)</label>
        <input type="number" id="am" value="60" step="1"/>
      </div>
    </div>

    <div class="actions" style="margin:12px 0">
      <button class="btn primary" onclick="addRow()">Añadir microrruta</button>
      <button class="btn ghost" onclick="calcAll()">Calcular</button>
      <span class="pill">Fórmulas: FTE<sub>b</sub>=L/r<sub>b</sub>·(1+α)/η; FTE<sub>r</sub>=T/r<sub>r</sub>·(1+α)/η</span>
    </div>

    <table id="tbl">
      <thead>
        <tr>
          <th>Microrruta</th><th>km barrido/d</th><th>t recolección/d</th><th>FTE barrido</th><th>FTE recolección</th><th>FTE total</th><th>FTE mañana</th><th>FTE tarde</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="kpi" style="margin-top:10px">
      <span class="pill">Consejo: ajusta α cuando preveas picos de lluvia o ausentismo estacional.</span>
    </div>
  </section>

  <!-- DESEMPEÑO -->
  <section id="desempeno" class="card" style="display:none">
    <h2>2) Matriz de desempeño e incentivos</h2>
    <p class="lead">Puntaje compuesto (0–100) y bono mensual por cuadrilla en función de <b>OTIF</b>, <b>PQR/10k</b>, <b>TAT</b> e <b>incidentes HSE</b>.</p>
    <div class="grid">
      <div><label>OTIF (%)</label><input type="number" id="m_otif" value="95" step="0.1"></div>
      <div><label>PQR por 10k (menor mejor)</label><input type="number" id="m_pqr" value="32" step="0.1"></div>
      <div><label>TAT (días)</label><input type="number" id="m_tat" value="10" step="0.1"></div>
      <div><label>Incidentes HSE (mes)</label><input type="number" id="m_hse" value="0" step="1"></div>
      <div><label>Peso OTIF</label><input type="number" id="w_otif" value="0.40" step="0.01"></div>
      <div><label>Peso PQR</label><input type="number" id="w_pqr" value="0.30" step="0.01"></div>
      <div><label>Peso TAT</label><input type="number" id="w_tat" value="0.20" step="0.01"></div>
      <div><label>Peso HSE</label><input type="number" id="w_hse" value="0.10" step="0.01"></div>
      <div><label>Base bono (COP)</label><input type="number" id="base_bono" value="180000" step="1000"></div>
    </div>
    <div class="actions" style="margin:12px 0">
      <button class="btn primary" onclick="calcScore()">Calcular score y bono</button>
      <span class="pill">Normalizaciones: OTIF 92→0; 100→100. PQR 45→0; 20→100. TAT 13→0; 7.5→100. HSE 3→0; 0→100</span>
    </div>
    <div id="scoreout" class="grid"></div>
  </section>

  <!-- ROI -->
  <section id="roi" class="card" style="display:none">
    <h2>3) Programa de formación y ROI</h2>
    <p class="lead">Evalúa el retorno mensual considerando costos de formación y ahorros por menor PQR y horas extra.</p>
    <div class="grid">
      <div><label>Costo formación (COP/mes)</label><input type="number" id="costo" value="12000000" step="500000"></div>
      <div><label>Ahorro por menor PQR (COP/mes)</label><input type="number" id="apqr" value="3200000" step="100000"></div>
      <div><label>Ahorro por menor horas extra (COP/mes)</label><input type="number" id="ahextra" value="1700000" step="100000"></div>
    </div>
    <div class="actions" style="margin:12px 0">
      <button class="btn primary" onclick="calcROI()">Calcular ROI</button>
      <span class="pill">ROI(%) = (Ahorro total − Costo) / Costo × 100</span>
    </div>
    <div id="roiout" class="grid"></div>
  </section>

</div>
<footer>© 2025 Calculadora GH+EC • Plantilla demostrativa para Urbaser Montería</footer>

<script>
 // Tabs
 document.querySelectorAll('.tabbtn').forEach(btn=>{
   btn.addEventListener('click',()=>{
     document.querySelectorAll('.tabbtn').forEach(b=>b.classList.remove('active'));
     document.querySelectorAll('section.card').forEach(s=>s.style.display='none');
     btn.classList.add('active');
     document.getElementById(btn.dataset.tab).style.display='block';
   });
 });

 // DOTACIÓN
 const tbody = document.querySelector('#tbl tbody');
 function addRow(){
   const tr = document.createElement('tr');
   tr.innerHTML = `
     <td contenteditable>Microrruta</td>
     <td contenteditable>30</td>
     <td contenteditable>120</td>
     <td>–</td><td>–</td><td>–</td><td>–</td><td>–</td>
   `;
   tbody.appendChild(tr);
 }
 addRow(); addRow(); // dos filas de inicio

 function calcAll(){
   const rb = parseFloat(document.getElementById('rb').value||4);
   const rr = parseFloat(document.getElementById('rr').value||6.5);
   const a = parseFloat(document.getElementById('alpha').value||0.25);
   const eta = parseFloat(document.getElementById('eta').value||0.9);
   const am = parseFloat(document.getElementById('am').value||60)/100;
   [...tbody.rows].forEach(row=>{
     const L = parseFloat(row.cells[1].innerText||0);
     const T = parseFloat(row.cells[2].innerText||0);
     const fte_b = (L/rb)*(1+a)/eta;
     const fte_r = (T/rr)*(1+a)/eta;
     const fte = fte_b + fte_r;
     row.cells[3].innerText = fte_b.toFixed(1);
     row.cells[4].innerText = fte_r.toFixed(1);
     row.cells[5].innerText = fte.toFixed(1);
     row.cells[6].innerText = (fte*am).toFixed(1);
     row.cells[7].innerText = (fte*(1-am)).toFixed(1);
   })
 }

 // SCORE & BONO
 function clamp(x,min,max){return Math.min(max,Math.max(min,x))}
 function nOTIF(x){return clamp((x-92)/(100-92)*100,0,100)}
 function nInv(x,lo,hi){x=clamp(x,lo,hi);return (hi-x)/(hi-lo)*100}
 function calcScore(){
   const ot = parseFloat(document.getElementById('m_otif').value||0);
   const pq = parseFloat(document.getElementById('m_pqr').value||0);
   const ta = parseFloat(document.getElementById('m_tat').value||0);
   const hs = parseFloat(document.getElementById('m_hse').value||0);
   const w1 = parseFloat(document.getElementById('w_otif').value||0.4);
   const w2 = parseFloat(document.getElementById('w_pqr').value||0.3);
   const w3 = parseFloat(document.getElementById('w_tat').value||0.2);
   const w4 = parseFloat(document.getElementById('w_hse').value||0.1);
   const b  = parseFloat(document.getElementById('base_bono').value||180000);

   const s1 = nOTIF(ot), s2 = nInv(pq,20,45), s3 = nInv(ta,7.5,13), s4 = nInv(hs,0,3);
   const score = (w1*s1 + w2*s2 + w3*s3 + w4*s4);
   let factor = 0; if(score>=95) factor=1.6; else if(score>=85) factor=1.3; else if(score>=75) factor=1.0; else if(score>=60) factor=0.5; else factor=0.0;
   const bono = Math.round(factor*b);

   const out = document.getElementById('scoreout');
   out.innerHTML = `
     <div class="card"><div class="kpi"><span class="big">${score.toFixed(1)}</span><span class="pill">Score compuesto</span></div>
     <div class="grid" style="margin-top:8px">
       <div class="pill">OTIF → ${s1.toFixed(1)}</div>
       <div class="pill">PQR → ${s2.toFixed(1)}</div>
       <div class="pill">TAT → ${s3.toFixed(1)}</div>
       <div class="pill">HSE → ${s4.toFixed(1)}</div>
     </div></div>
     <div class="card"><div class="kpi"><span class="big">$ ${bono.toLocaleString('es-CO')}</span><span class="pill">Bono mensual estimado</span></div></div>
   `;
 }

 // ROI
 function calcROI(){
   const c = parseFloat(document.getElementById('costo').value||0);
   const p = parseFloat(document.getElementById('apqr').value||0);
   const h = parseFloat(document.getElementById('ahextra').value||0);
   const ahorro = p + h;
   const roi = ((ahorro - c)/c)*100;
   const out = document.getElementById('roiout');
   const cls = roi>=0? 'ok' : 'bad';
   out.innerHTML = `
     <div class="card"><div class="kpi ${cls}"><span class="big">${roi.toFixed(1)}%</span><span class="pill">ROI mensual</span></div>
     <p class="lead">Ahorro total: $ ${ahorro.toLocaleString('es-CO')} • Costo: $ ${c.toLocaleString('es-CO')}</p></div>`;
 }
</script>
</body>
</html>
